
def define_executable_rule():
    target = "__fawm_config__"
    sources = ["main.c", "memory.c", "lex.yy.c", "y.tab.c"]
    # YY_NO_UNPUT orders lex.yy.c to exclude yyunput(), YY_NO_INPUT excludes
    # input().
    cflags = ["-Wall", "-Werror", "-O3", "-g", "-DYY_NO_UNPUT", "-DYY_NO_INPUT"]
    includes = ["{top_dir}/include", "/usr/local/include"]
    program(**locals())

def define_lexer_rule():
    targets = "lex.yy.c"
    sources = "conf.l"
    commands = "lex {sources}"
    command(**locals())

def define_parser_rule():
    targets = ["y.tab.c", "y.tab.h"]
    sources = "conf.y"
    commands = "yacc -dv {sources}"
    command(**locals())

def build():
    define_executable_rule()
    define_parser_rule()
    define_lexer_rule()

# vim: tabstop=4 shiftwidth=4 expandtab softtabstop=4 filetype=python
